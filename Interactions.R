# MAC í•œê¸€ ì„¤ì •
par(family = "NanumGothic")

install.packages("interactions")

library(dplyr)
library(interactions)
library(ggplot2)

# ë‚´ì¥ ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°
data("LifeCycleSavings")

df <- LifeCycleSavings %>%
  rename(
    ì €ì¶•ë¥  = sr,
    ê°€ì²˜ë¶„ì†Œë“ = dpi,
    ì‹¤ì§ˆì†Œë“ì¦ê°€ìœ¨ = ddpi,
    ì Šì€ì¸µë¹„ìœ¨ = pop15,
    ë…¸ë…„ì¸µë¹„ìœ¨ = pop75
  )


# íšŒê·€ëª¨ë¸: ì €ì¶•ë¥  = ì Šì€ì¸µ + ì„±ì¥ë¥  + ìƒí˜¸ì‘ìš©
model_pop15 <- lm(ì €ì¶•ë¥  ~ ì Šì€ì¸µë¹„ìœ¨ * ì‹¤ì§ˆì†Œë“ì¦ê°€ìœ¨, data = df)
summary(model_pop15)


# ì¡°ì ˆíš¨ê³¼ ì‹œê°í™” 1 
# ì Šì€ì¸µ ë¹„ìœ¨(pop15)ì´ ë§ì„ìˆ˜ë¡, ì„±ì¥ë¥ (ddpi)ì˜ íš¨ê³¼ê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ê°€?


plot_pop15 <- interact_plot(
  model_pop15,
  pred = ì Šì€ì¸µë¹„ìœ¨,          # Xì¶•(ì£¼íš¨ê³¼)
  modx = ì‹¤ì§ˆì†Œë“ì¦ê°€ìœ¨,      # ì¡°ì ˆë³€ìˆ˜
  plot.points = FALSE,
  interval = TRUE
) +
  labs(
    title = "ì Šì€ì¸µ ë¹„ìœ¨ Ã— ì„±ì¥ë¥ ì´ ì €ì¶•ë¥ ì— ë¯¸ì¹˜ëŠ” ì¡°ì ˆ íš¨ê³¼",
    x = "ì Šì€ì¸µ ë¹„ìœ¨(%)",
    y = "ì €ì¶•ë¥ ",
    color = "ì‹¤ì§ˆì†Œë“ ì¦ê°€ìœ¨(ì„±ì¥ë¥ )"
  ) +
  theme_bw(base_size = 10) 

plot_pop15



# ëª¨ë¸ 2: pop75 ì¡°ì ˆ
model_pop75 <- lm(ì €ì¶•ë¥  ~ ë…¸ë…„ì¸µë¹„ìœ¨ * ì‹¤ì§ˆì†Œë“ì¦ê°€ìœ¨, data = df)
summary(model_pop75)

# ì¡°ì ˆíš¨ê³¼ ì‹œê°í™” 2
# ë…¸ë…„ì¸µ(pop75)ì˜ ë¹„ìœ¨ì´ ë†’ì„ ë•Œ ì„±ì¥ë¥ ì´ ì €ì¶•ë¥ ì— ë¯¸ì¹˜ëŠ” íš¨ê³¼ëŠ”?

plot_pop75 <- interact_plot(
  model_pop75,
  pred = ë…¸ë…„ì¸µë¹„ìœ¨,
  modx = ì‹¤ì§ˆì†Œë“ì¦ê°€ìœ¨,
  plot.points = FALSE,
  interval = TRUE
) +
  labs(
    title = "ë…¸ë…„ì¸µ ë¹„ìœ¨ Ã— ì„±ì¥ë¥ ì´ ì €ì¶•ë¥ ì— ë¯¸ì¹˜ëŠ” ì¡°ì ˆ íš¨ê³¼",
    x = "ë…¸ë…„ì¸µ ë¹„ìœ¨(%)",
    y = "ì €ì¶•ë¥ ",
    color = "ì‹¤ì§ˆì†Œë“ ì¦ê°€ìœ¨(ì„±ì¥ë¥ )"
  ) +
  theme_bw(base_size = 10)

plot_pop75

'
-1 SD: í‰ê· ë³´ë‹¤ ê²½ì œì„±ì¥ë¥ ì´ ë‚®ì€ ë‚˜ë¼
Mean: ë³´í†µ ìˆ˜ì¤€
+1 SD: í‰ê· ë³´ë‹¤ ê²½ì œì„±ì¥ë¥ ì´ ë†’ì€ ë‚˜ë¼

ì´ë ‡ê²Œ 3ê°€ì§€ ê·¸ë£¹ì—ì„œ
"ì Šì€ì¸µ ë¹„ìœ¨ì´ ì €ì¶•ë¥ ì— ì–´ë–»ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€" ë¹„êµ

'

"
ğŸ‘‰ ê¸°ìš¸ê¸°ê°€ í¬ë‹¤ = ì˜í–¥ë ¥ì´ í¬ë‹¤
ğŸ‘‰ ê¸°ìš¸ê¸°ê°€ ì‘ë‹¤(í‰í‰í•˜ë‹¤) = ì˜í–¥ë ¥ì´ ì•½í•˜ë‹¤

ì„ ì´ ê°€íŒŒë¥´ê²Œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ë©´ â†’ ì Šì€ì¸µë¹„ìœ¨ì´ ì¦ê°€í• ìˆ˜ë¡ ì €ì¶•ë¥ ì´ í¬ê²Œ ê°ì†Œ
ì„ ì´ ê±°ì˜ ìˆ˜í‰ì´ë©´ â†’ ì Šì€ì¸µë¹„ìœ¨ì´ ì¦ê°€í•´ë„ ì €ì¶•ë¥ ì€ ê±°ì˜ ë³€í•˜ì§€ ì•ŠìŒ


âœ” íŒ¨í„´ 1. ì„±ì¥ë¥  ë‚®ì€ êµ­ê°€(-1 SD)

ì„ ì´ ê°€ì¥ ê°€íŒŒë¥´ê²Œ ì•„ë˜ë¡œ ë‚´ë ¤ê°
â†’ ì Šì€ì¸µì´ ë§ì•„ì§€ë©´ ì €ì¶•ë¥ ì´ í¬ê²Œ ë–¨ì–´ì§

âœ” íŒ¨í„´ 2. ì„±ì¥ë¥  í‰ê· ì¸ êµ­ê°€

ê¸°ìš¸ê¸° ì¤‘ê°„
â†’ ì˜í–¥ì€ ìˆì§€ë§Œ ì•½í•´ì§

âœ” íŒ¨í„´ 3. ì„±ì¥ë¥  ë†’ì€ êµ­ê°€(+1 SD)

ì„ ì´ ê°€ì¥ ì™„ë§Œí•¨, ê±°ì˜ ìˆ˜í‰
â†’ ì Šì€ì¸µì´ ì¦ê°€í•´ë„ ì €ì¶•ë¥ ì´ ê±°ì˜ ì•ˆ ë–¨ì–´ì§
â†’ ì¦‰, ì„±ì¥ë¥ ì´ ë†’ìœ¼ë©´ ì Šì€ì¸µ ì¦ê°€ì˜ ë¶€ì •ì  ì˜í–¥ì´ ì•½í•´ì§
"


### ê²°ê³¼ : ì Šì€ì¸µ ë¹„ìœ¨ì´ ì €ì¶•ë¥ ì„ ë‚®ì¶”ëŠ” íš¨ê³¼ëŠ” ì„±ì¥ë¥ ì´ ë†’ì€ ë‚˜ë¼ì¼ìˆ˜ë¡ ì•½í•´ì§„ë‹¤.







